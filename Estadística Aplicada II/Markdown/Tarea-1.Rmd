---
output:
  word_document: default
  html_document: default
  pdf_document: default
---
--
title: "Estadística Aplicada II- Taller # 1"
author: "David Rojas y Felipe Palomino"
date: "31/03/2023"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
  
<div class=text-justify>  
  

</div>

<div class=text-center>
\textbf{Tarea 1}

</div>
<div class=text-justify>    
\textbf{A}) Describa las variables e individuos del subgrupo asignado en la base Yarn. Realice el gráfico de dispersión entre las variables y=densidad y la variable x=$NIR_{j}$ que presentan la mayor correlación.\\
\textbf{Estadísticas descriptivas:} Para el cálculo de estas estadística realizamos una función que agrupaba diferentes descriptivas en una sola tabla, añadiendo a su vez, histogramas, junto con las correlaciones lineales de pearson entre las covariables.
</div>

```{r,echo=TRUE,message=FALSE,warning=FALSE}
#Importamos la base de datos
##############################
options(scipen=999) # Realizamos este cambio en options para trabajar sin notación científica
#
library(easypackages) #Librería para la carga de base de datos
lib_req<-c('psych','car','lmtest','MASS','xtable','latex2exp',
           'orcutt','nlme',
           'mixtools',"alr4","depth","readr",
           "ddalpha","robustbase","rrcov","zoom",
           'ggfortify','readxl')# Listado de librerias requeridas por el script
easypackages::packages(lib_req) 
data <- read_excel("C:/Users/sebas/OneDrive/Escritorio/Octavo Semestre/OctavoSemestre/Estadística Aplicada II/Base de datos/data.xlsx")
#Función creada para las estadística descriptivas
resumen<- function(x){
  X<- matrix(0,7,1)
  resumen<- round(c(mean(x),median(x),min(x),max(x)
                  ,sd(x),quantile(x,0.25),
                    quantile(x,0.75)),4)
  for( i  in 1:7){
    X[i,]<- resumen[i]
  }
  rownames(X)<-c('Media','Mediana','Min','Max','Sd','1st Qu.','3rd Qu')
  colnames(X)<- (paste(colnames(x)))
  return(X)
}
X<- data
################ Selección de las variables dadas por el docente
X<- cbind(X[,1:30],X[,colnames(X)=='density'])
# EstadC-stica descriptivas
summary<- matrix(0,31,7)
for(i in 1:31){
  summary[i,]<- t(resumen(X[,i]))
}
rownames(summary)<-colnames(X)
colnames(summary)<-c('Media','Mediana','Min','Max','Sd','1st Qu.','3rd Qu')
print(summary)
#Selección de variables con mayor correlación lineal de pearson positiva o negativa
Y<-cor(X)
Y[31,]
Y<-Y[,-31]
cor<-c(max(Y[31,]),min(Y[31,]))
which(Y[31,]==cor[1])
which(Y[31,]==cor[2])
windows(height=10, width=10)  
#Creación del panel de fondo
par(mfrow=c(1,1))
plot(seq(min(X[,29]),max(X[,29]),length.out=30),seq(min(X[,31]),max(X[,31]),length.out=30),type='n',xlab='',ylab='')
grid(10,10,col=c('aquamarine3','blue4'))
par(new=T)
plot(X[,31]~X[,29],ylab='Densidad',xlab=' NIR 29',pch=19,axes=F)
model<- lm(density~NIR29,data=X)
abline(model,lwd=2)
summary(model)
```
<div class=text-justify> 

</div>

```{r}


```

<div class=text-justify> 

</div>

$$H_0: \mu = 130\qquad vs \qquad H_1: \mu = 130$$


</div>
<< echo=TRUE,warning=FALSE, message=FALSE>>=
```{r}
windows(height=8, width=10)               # Nueva ventana gráfica, con dimensiones preestablecidas
par(mfrow=c(2,2))                         # particón dela ventana gráfica

hist(X[,1], freq=F,main="",xlab="Temp Activación")
lines(density(X[,1]), col="blue",lty=2)
legend("topright","Densidad estimada",lty=2, col="blue",bg='lightblue')
boxplot(X[,1],col="Blue", ylab="Temp Activación")
qqnorm(X[,1]); qqline(X[,1])
```
@

<div class=text-justify>    
La forma asimétrica del histograma y del boxplot, ademas de la distancia de los puntos a la linea recta en el *qqplot*, sugieren que los datos no provienen de una distribución *Normal*. Este resultados son corroborados por el *test de Shapiro-Wilk*.
</div>


```{r}
# Un Test formal de Normalidad
shapiro.test(X[,1])
```

##### Ejercicio 4.  

<div class=text-justify>    
Al seleccionar un concreto azufrado para la construcción de carreteras en regiones que experimentan congelamiento intenso, es importante que el concreto tenga baja conductividad térmica, a fin de reducir el da?o posterior debido a temperaturas cambiantes. Se ha pensado que la adición de agregados graduados a las mezcla de concreto puede disminuir su conductividad media. Para ello se ha diseñado un experimento que consiste en generar especímenes de prueba bajo las dos condiciones, (con agregados, sin agregados). Los resultados son lo siguientes:

***Con agregados***  

0.166, 0.296, 0.249, 0.366, 0.415, 0.388, 0.273, 0.324, 0.413, 0.280, 0.247, 0.130,	
0.279, 0.364, 0.402, 0.202, 0.255, 0.315, 0.375, 0.316  

***Sin agregados***  

0.426, 0.461, 0.476, 0.467, 0.436, 0.509, 0.428, 0.508, 0.457, 0.513, 0.448, 0.523, 
0.431, 0.439, 0.395, 0.443, 0.361, 0.480, 0.467, 0.436, 0.471, 0.487, 0.498, 0.538, 0.500  

De acuerdo con los datos, incorporar agregados disminuye la conductividad térmica del material?

</div>

```{r}

#Ingresando los datos en el formato variable - indicador
rt = c(0.166, 0.296, 0.249, 0.366, 0.415, 0.388, 0.273, 0.324, 0.413, 0.280, 0.247, 0.130,	
       0.279, 0.364, 0.402, 0.202, 0.255, 0.315, 0.375, 0.316,
       0.426, 0.461, 0.476, 0.467, 0.436, 0.509, 0.428, 0.508, 0.457, 0.513, 0.448, 0.523, 
       0.431, 0.439, 0.395, 0.443, 0.361, 0.480, 0.467, 0.436, 0.471, 0.487, 0.498, 0.538, 0.500)
Ag = factor(c(rep("Con Agregado",20), rep("Sin Agregado",25)))
```     

Inicialmente realizaremos un análisis exploratorio, que incluye el calculo de algunos indicadores descriptivos y la representación gráfica de los datos.

```{r}

# Algunas medidas resumen.
promedios = tapply(rt,Ag,mean)
desviacion = tapply(rt,Ag,sd)
C_var = desviacion/promedios
resumen =round(cbind(promedios, desviacion, C_var),2)
colnames(resumen)= c("Promedio","Desviación","Coef.Var")
resumen

#Cambiando los datos al formato de columnas
rt_ca=rt[Ag =="Con Agregado"]                #resistencia térmica con agregado
rt_sa=rt[Ag =="Sin Agregado"]                #resistencia térmica sin agregado

#Preparando la ventana gráfica
M = matrix(c(1,2,3,3,4,5),ncol=3,byrow = F)  # matriz con la ubicación de 5 gráficos  
windows(height=20, width=15)                 # Nueva ventana gráfica  
layout(M)                                    # partición dela ventana gráfica según M

# Histogramas de frecuencia con densidad estimada - igualado el rango en el eje X.

hist(rt_ca, freq=F,main="",xlab="Resistencia Térmica",xlim=range(rt))
lines(density(rt_ca), col="blue",lty=2)
hist(rt_sa, freq=F,main="",xlab="Resistencia Térmica",xlim=range(rt))
lines(density(rt_sa), col="blue",lty=2)
boxplot(rt~Ag,col="Blue", ylab="Resistencia Térmica")
qqnorm(rt_ca); qqline(rt_ca)
qqnorm(rt_sa); qqline(rt_sa)
```


<div class=text-justify>
Los resultados muestran que la muestra obtenida con la adición de agregados tiene una menor conductividad eléctrica que aquella muestra que no incorporó estos agregados. La representación gráfica también sugiere que la distribución de la variable, en ambos casos, es simétrica y no se aleja mucho de la distribución normal. Lo anterior se corroboró con el test *Shapiro-Wilk* para ambas muestras.
</div>

```{r}
# Un Test de Normalidad
shapiro.test(rt_ca)
shapiro.test(rt_sa)
```

<div class=text-justify> 
Verificado el supuesto de normalidad para ambas poblaciones, procedemos a desarrollar el test de hipotésis:
</div>

$$H_0: \mu_{CA} = \mu_{SA} \qquad vs \qquad H_1: \mu_{CA} < \mu_{SA}$$
<div class=text-justify> 

los resultados del test son los siguientes:
</div>

```{r}
# Un Test de Hipotesis Paramétrico
t.test(rt_ca,rt_sa,alternative = "less")   
```

<div class=text-justify> 
De acuerdo con el $valor-p$ si existe una reducción en la conductividad térmica del concreto cuando se adicionan los agregados en la mezcla
</div>
